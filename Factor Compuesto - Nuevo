SELECT /*+PARALLEL (18)*/
	COLLID.CLCOLLID, 
	COLLID.CLNAME,   
	COLLID.CLUTYPE, 
	COLLID.CLAGENCY, 
	COLLID.CLDEPT 
FROM rcvry.COLLID 
ORDER BY 1

/

SELECT /*+PARALLEL (18)*/
	 DISTINCT TRUNC(PTPSCHED.PPDUE), 
	 PTPSCHED.PPCOLLID, 
	 COUNT(DISTINCT PTPSCHED.PPACCT), 
	 COUNT(DISTINCT PMTFIL.PMACCT), 
	 COUNT(DISTINCT PMTFIL.PMTDDESC), 
	 SUM (PMTFIL.PMTAMT) 
FROM 
	rcvry.PMTFIL,
	rcvry.DELQMST, 
	rcvry.PTPSCHED 
WHERE 
	((PTPSCHED.PPACCTG in ('6','5')) 
		AND (PTPSCHED.PPFLAG = 'C') 
		AND (TRUNC(PTPSCHED.PPDUE) BETWEEN TRUNC(to_date('01/02/2026','dd/mm/yyyy')) AND TRUNC(TO_DATE(SYSDATE-1)))
		AND (DELQMST.DMACCTG in ('6','5')) 
		AND (PMTFIL.PMACCTG in ('6','5')) 
		AND (TRUNC(PMTFIL.PMTDATE) BETWEEN TRUNC(PTPSCHED.PPMADE) AND TRUNC(PTPSCHED.PPDUE))
		AND (PMTFIL.PMQUE NOT IN ('RC00','RCA0','RCA1','RCA2','RCA3','RCA4','RCA5','RCA6','RCA7','RCA8','RCA9','RCM0','RCM1','RCM2','RCM3','RCM4','RCM5','RCM6','RCM7','RCM8','RCM9','REAC','NOQ1','NOQ2','NOQ3','NOQ4','NOQ5','NOQ6','NOQ7','NOQ8','NOQ9')
		OR PMTFIL.PMQUE IS NULL)) 
	AND PTPSCHED.PPACCTG = DELQMST.DMACCTG 
	AND PTPSCHED.PPACCT = DELQMST.DMACCT 
	AND DELQMST.DMACCTG = PMTFIL.PMACCTG 
	AND DELQMST.DMACCT = PMTFIL.PMACCT 
GROUP BY 
	TRUNC(PTPSCHED.PPDUE), 
	PTPSCHED.PPCOLLID

/
	
	SELECT /*+PARALLEL (18)*/
	date1, workeddate1, name_1, nvl(workedAccts,0) workedAccts, nvl(productiveAccts,0) productiveAccts, nvl((productiveAccts / workedAccts),0) percProductiveAccts, nvl(ppGeneradas,0) ppGeneradas, nvl((ppGeneradas / productiveAccts),0) percPPGeneradas, nvl(totPPAccts,0) totPPAccts, nvl(keptPPAccts,0) keptPPAccts, nvl((keptPPAccts / totPPAccts),0) percKeptPPAcctsVsTotPPAccts, nvl(brokenppaccts,0) brokenppaccts, nvl((brokenPPAccts / totPPAccts),0) percBrokPPAcctsVsTotPPAccts
FROM

(SELECT DISTINCT TRUNC(ACTFIL.ACACTDTE) date1, ACTFIL.ACCIDNAM name_1
FROM rcvry.ACTFIL
WHERE TRUNC(ACTFIL.ACACTDTE) BETWEEN TRUNC(TO_DATE('01/02/2026', 'dd/mm/yyyy'))AND TRUNC(TO_DATE(SYSDATE-1))

UNION

SELECT DISTINCT TRUNC(PTPSCHED.PPDUE) date1, PTPSCHED.PPCOLLID
FROM rcvry.PTPSCHED
WHERE TRUNC(PTPSCHED.PPDUE) BETWEEN TRUNC(TO_DATE('01/02/2026', 'dd/mm/yyyy'))AND TRUNC(TO_DATE(SYSDATE-1))
AND (PTPSCHED.PPQUE NOT IN ('RC00','RCA0','RCA1','RCA2','RCA3','RCA4','RCA5','RCA6','RCA7','RCA8','RCA9','RCM0','RCM1','RCM2','RCM3',
'RCM4','RCM5','RCM6','RCM7','RCM8','RCM9','REAC','NOQ1','NOQ2','NOQ3','NOQ4','NOQ5','NOQ6','NOQ7','NOQ8','NOQ9') OR PTPSCHED.PPQUE IS NULL)) date_1

FULL OUTER JOIN

(SELECT TRUNC(ACTFIL.ACACTDTE) workeddate1, COLLID.CLCOLLID workedCollid, COUNT(DELQMST.DMACCT) workedAccts
FROM rcvry.ACTVERTB, rcvry.DELQMST, rcvry.ACTFIL, rcvry.COLLID
WHERE ((TRUNC(ACTFIL.ACACTDTE) BETWEEN TRUNC(TO_DATE('01/02/2026', 'dd/mm/yyyy'))AND TRUNC(TO_DATE(SYSDATE-1)))
AND (COLLID.CLUTYPE IN ('1','2'))
AND (ACTVERTB.AVTYPE = 'R')
AND (ACTFIL.ACSEQNUM = '1')
AND ACTVERTB.AVACCTG IN ('6','5'))

AND COLLID.CLCOLLID = ACTFIL.ACCIDNAM
AND ACTFIL.ACACCTG = DELQMST.DMACCTG
AND ACTFIL.ACACCT = DELQMST.DMACCT
AND ACTFIL.ACRCCODE = ACTVERTB.AVCODE
AND DELQMST.DMACCTG = ACTVERTB.AVACCTG
GROUP BY TRUNC(ACTFIL.ACACTDTE), COLLID.CLCOLLID) worked

ON date1 = workeddate1
AND name_1 = workedCollid

FULL OUTER JOIN

(SELECT TRUNC(ACTFIL.ACACTDTE) workeddate2, COLLID.CLCOLLID productiveCollid, COUNT(DELQMST.DMACCT) productiveAccts
FROM rcvry.ACTVERTB, rcvry.DELQMST, rcvry.ACTFIL, rcvry.COLLID
WHERE ((TRUNC(ACTFIL.ACACTDTE) BETWEEN TRUNC(TO_DATE('01/02/2026', 'dd/mm/yyyy'))AND TRUNC(TO_DATE(SYSDATE-1)))
AND(COLLID.CLUTYPE IN ('1','2'))
AND (ACTVERTB.AVTYPE = 'R')
AND (ACTFIL.ACSEQNUM = '1')
AND (ACTVERTB.avcode NOT IN ('PG'))
AND (ACTVERTB.avcntflg = 1)
AND ACTVERTB.AVACCTG IN ('6','5'))

AND COLLID.CLCOLLID = ACTFIL.ACCIDNAM
AND ACTFIL.ACACCTG = DELQMST.DMACCTG
AND ACTFIL.ACACCT = DELQMST.DMACCT
AND ACTFIL.ACRCCODE = ACTVERTB.AVCODE
AND DELQMST.DMACCTG = ACTVERTB.AVACCTG
GROUP BY TRUNC(ACTFIL.ACACTDTE), COLLID.CLCOLLID) productive

ON name_1 = productiveCollid
AND date1 = workeddate2

FULL OUTER JOIN

(SELECT TRUNC(ACTFIL.ACACTDTE) workeddate3, COLLID.CLCOLLID ppGenCollid, COUNT(DELQMST.DMACCT) ppGeneradas
FROM rcvry.ACTVERTB, rcvry.DELQMST, rcvry.ACTFIL, rcvry.COLLID
WHERE ((TRUNC(ACTFIL.ACACTDTE) BETWEEN TRUNC(TO_DATE('01/02/2026', 'dd/mm/yyyy')) AND TRUNC(TO_DATE(SYSDATE-1)))
AND(COLLID.CLUTYPE IN ('1','2'))
AND (ACTVERTB.AVTYPE = 'R')
AND (ACTFIL.ACSEQNUM = '1')
AND (ACTVERTB.avcode = 'PP')
AND (ACTVERTB.avcntflg = 1)
AND ACTVERTB.AVACCTG IN ('6','5'))

AND COLLID.CLCOLLID = ACTFIL.ACCIDNAM
AND ACTFIL.ACACCTG = DELQMST.DMACCTG
AND ACTFIL.ACACCT = DELQMST.DMACCT
AND ACTFIL.ACRCCODE = ACTVERTB.AVCODE
AND DELQMST.DMACCTG = ACTVERTB.AVACCTG

GROUP BY TRUNC(ACTFIL.ACACTDTE), COLLID.CLCOLLID) ppGen

ON name_1 = ppGenCollid
AND date1 = workeddate3

LEFT OUTER JOIN

(SELECT TRUNC(PTPSCHED.PPDUE) workeddate4, COLLID.CLCOLLID totPPCollid, COUNT(DELQMST.DMACCT) totPPAccts
FROM rcvry.DELQMST, rcvry.COLLID, rcvry.PTPSCHED
WHERE ((TRUNC(PTPSCHED.PPDUE) BETWEEN TRUNC(TO_DATE('01/02/2026', 'dd/mm/yyyy'))AND TRUNC(TO_DATE(SYSDATE-1)))
AND (COLLID.CLUTYPE IN ('1','2'))
AND (PTPSCHED.PPFLAG IN ('C', 'R'))
AND (PTPSCHED.PPQUE NOT IN ('RC00','RCA0','RCA1','RCA2','RCA3','RCA4','RCA5','RCA6','RCA7','RCA8','RCA9','RCM0','RCM1','RCM2','RCM3',
'RCM4','RCM5','RCM6','RCM7','RCM8','RCM9','REAC','NOQ1','NOQ2','NOQ3','NOQ4','NOQ5','NOQ6','NOQ7','NOQ8','NOQ9') OR PTPSCHED.PPQUE IS NULL))
AND COLLID.CLCOLLID = PTPSCHED.PPCOLLID
AND PTPSCHED.PPACCTG = DELQMST.DMACCTG
AND PTPSCHED.PPACCT = DELQMST.DMACCT
GROUP BY TRUNC(PTPSCHED.PPDUE), COLLID.CLDEPT, COLLID.CLCOLLID) totPP

ON name_1 = totPPCollid
AND date1 = workeddate4

FULL OUTER JOIN

(SELECT TRUNC(PTPSCHED.PPDUE) workeddate5, COLLID.CLCOLLID keptPPCollid, COUNT(PTPSCHED.PPACCT) keptPPAccts
FROM rcvry.COLLID, rcvry.PTPSCHED
WHERE ((TRUNC(PTPSCHED.PPDUE) BETWEEN TRUNC(TO_DATE('01/02/2026', 'dd/mm/yyyy'))AND TRUNC(TO_DATE(SYSDATE-1)))
AND(COLLID.CLUTYPE IN ('1','2'))
AND (PTPSCHED.PPFLAG = 'C')
AND (PTPSCHED.PPQUE NOT IN ('RC00','RCA0','RCA1','RCA2','RCA3','RCA4','RCA5','RCA6','RCA7','RCA8','RCA9','RCM0','RCM1','RCM2','RCM3',
'RCM4','RCM5','RCM6','RCM7','RCM8','RCM9','REAC','NOQ1','NOQ2','NOQ3','NOQ4','NOQ5','NOQ6','NOQ7','NOQ8','NOQ9') OR PTPSCHED.PPQUE IS NULL))
AND PTPSCHED.PPCOLLID = COLLID.CLCOLLID
GROUP BY TRUNC(PTPSCHED.PPDUE), COLLID.CLCOLLID, COLLID.CLDEPT) keptPP

ON name_1 = keptPPCollid
AND date1 = workeddate5

FULL OUTER JOIN

(SELECT TRUNC(PTPSCHED.PPDUE) workeddate6, COLLID.CLCOLLID brokenPPCollid, COUNT(PTPSCHED.PPACCT) brokenPPAccts
FROM rcvry.COLLID, rcvry.PTPSCHED
WHERE ((TRUNC(PTPSCHED.PPDUE) BETWEEN TRUNC(TO_DATE('01/02/2026', 'dd/mm/yyyy'))AND TRUNC(TO_DATE(SYSDATE-1)))
AND(COLLID.CLUTYPE IN ('1','2'))
AND (PTPSCHED.PPFLAG = 'R')
AND (PTPSCHED.PPQUE NOT IN ('RC00','RCA0','RCA1','RCA2','RCA3','RCA4','RCA5','RCA6','RCA7','RCA8','RCA9','RCM0','RCM1','RCM2','RCM3',
'RCM4','RCM5','RCM6','RCM7','RCM8','RCM9','REAC','NOQ1','NOQ2','NOQ3','NOQ4','NOQ5','NOQ6','NOQ7','NOQ8','NOQ9') OR PTPSCHED.PPQUE IS NULL))
AND PTPSCHED.PPCOLLID = COLLID.CLCOLLID
GROUP BY TRUNC(PTPSCHED.PPDUE), COLLID.CLCOLLID, COLLID.CLDEPT) brokenPP

ON name_1 = brokenPPCollid
AND date1 = workeddate6

WHERE name_1 NOT IN ('mortegan')
ORDER BY date1, workeddate1

/

SELECT /*+PARALLEL (18)*/ 
date1, workeddate1, name_1, nvl(workedAccts,0) workedAccts

FROM

(SELECT DISTINCT TRUNC(ACTFIL.ACACTDTE) date1, ACTFIL.ACCIDNAM name_1
FROM rcvry.ACTFIL
WHERE TRUNC(ACTFIL.ACACTDTE) BETWEEN TRUNC(TO_DATE('01/02/2026', 'dd/mm/yyyy'))AND TRUNC(TO_DATE(SYSDATE-1))

UNION

SELECT DISTINCT TRUNC(PTPSCHED.PPDUE) date1, PTPSCHED.PPCOLLID
FROM rcvry.PTPSCHED
WHERE TRUNC(PTPSCHED.PPDUE) BETWEEN TRUNC(TO_DATE('01/02/2026', 'dd/mm/yyyy'))AND TRUNC(TO_DATE(SYSDATE-1))
AND (PTPSCHED.PPQUE NOT IN ('RC00','RCA0','RCA1','RCA2','RCA3','RCA4','RCA5','RCA6','RCA7','RCA8','RCA9','RCM0','RCM1','RCM2','RCM3',
'RCM4','RCM5','RCM6','RCM7','RCM8','RCM9','REAC','NOQ1','NOQ2','NOQ3','NOQ4','NOQ5','NOQ6','NOQ7','NOQ8','NOQ9') OR PTPSCHED.PPQUE IS NULL)) date_1

FULL OUTER JOIN

(SELECT TRUNC(ACTFIL.ACACTDTE) workeddate1, COLLID.CLCOLLID workedCollid, COUNT(DELQMST.DMACCT) workedAccts
FROM rcvry.ACTVERTB, rcvry.DELQMST, rcvry.ACTFIL, rcvry.COLLID
WHERE ((TRUNC(ACTFIL.ACACTDTE) BETWEEN TRUNC(TO_DATE('01/02/2026', 'dd/mm/yyyy'))AND TRUNC(TO_DATE(SYSDATE-1)))
AND (COLLID.CLUTYPE IN ('1','2'))
AND (ACTVERTB.AVTYPE = 'R')
AND (ACTFIL.ACSEQNUM = '1')
AND (ACTFIL.ACACCODE IN ('VD', 'VT', 'VO'))
AND ACTVERTB.AVACCTG IN ('6','5'))

AND COLLID.CLCOLLID = ACTFIL.ACCIDNAM
AND ACTFIL.ACACCTG = DELQMST.DMACCTG
AND ACTFIL.ACACCT = DELQMST.DMACCT
AND ACTFIL.ACRCCODE = ACTVERTB.AVCODE
AND DELQMST.DMACCTG = ACTVERTB.AVACCTG
GROUP BY TRUNC(ACTFIL.ACACTDTE), COLLID.CLCOLLID) worked

ON date1 = workeddate1
AND name_1 = workedCollid

WHERE name_1 LIKE 'i8%'
ORDER BY 1,2 
