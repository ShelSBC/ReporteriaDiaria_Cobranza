SELECT /*+parallel (8)*/
nvl(TEL1.CIUDAD,0)AS CIUDAD, 
nvl(TEL1.AGENCIA,0)AS AGENCIA, 
nvl(TEL1.ESTATUS_PROMESA,0)CODIGO,
nvl(TEL2.ESTATUS_PROMESA2,0)CODIGO2,
nvl(TEL3.ESTATUS_PROMESA3,0)CODIGO3,
nvl(TEL4.ESTATUS_PROMESA4,0)CODIGO4,
nvl(TEL5.ESTATUS_PROMESA5,0)CODIGO5,
nvl(TEL6.ESTATUS_PROMESA6,0)CODIGO6,
nvl(TELC.ESTATUS_PROMESAC,0)ESTATUS_PROMESA1,
nvl(TELR.ESTATUS_PROMESAR,0)ESTATUS_PROMESA2,
nvl(VIS2.ESTATUS_PROMESA_VIS2,0)CODIGO7,
nvl(VIS3.ESTATUS_PROMESA_VIS3,0)CODIGO8,
nvl(VIS4.ESTATUS_PROMESA_VIS4,0)CODIGO9,
nvl(VIS5.ESTATUS_PROMESA_VIS5,0)CODIGO10,
nvl(VIS6.ESTATUS_PROMESA_VIS6,0)CODIGO11,
nvl(VISC.ESTATUS_PROMESA_VISC,0)ESTATUS_PROMESA3,
nvl(VISR.ESTATUS_PROMESA_VISR,0)ESTATUS_PROMESA4,
nvl(INB2.ESTATUS_PROMESA_INB2,0)CODIGO12,
nvl(INB3.ESTATUS_PROMESA_INB3,0)CODIGO13,
nvl(INB4.ESTATUS_PROMESA_INB4,0)CODIGO14,
nvl(INB5.ESTATUS_PROMESA_INB5,0)CODIGO15,
nvl(INB6.ESTATUS_PROMESA_INB6,0)CODIGO16,
nvl(INBC.ESTATUS_PROMESA_INBC,0)ESTATUS_PROMESA5,
nvl(INBR.ESTATUS_PROMESA_INBR,0)ESTATUS_PROMESA6,
nvl(MEN2.ESTATUS_PROMESA_MEN2,0)CODIGO17,
nvl(MEN3.ESTATUS_PROMESA_MEN3,0)CODIGO18,
nvl(MEN4.ESTATUS_PROMESA_MEN4,0)CODIGO19,
nvl(MEN5.ESTATUS_PROMESA_MEN5,0)CODIGO20
FROM 
(SELECT RCVRY.AGENCY.AGCITY CIUDAD, RCVRY.COLLID.CLAGENCY AGENCIA, COUNT(RCVRY.ACTVERTB.AVCODE)ESTATUS_PROMESA
FROM RCVRY.ACTVERTB, RCVRY.ACTFIL, RCVRY.COLLID, RCVRY.AGENCY 
WHERE ACTFIL.ACACCTG IN ('5','6')
         AND TRUNC(RCVRY.ACTFIL.ACACTDTE) BETWEEN TRUNC(TO_DATE('01/07/2025','dd/mm/yyyy')) AND  TRUNC(SYSDATE) 
		 AND RCVRY.ACTVERTB.AVACCTG IN ('5','6')
		 AND RCVRY.ACTVERTB.AVTYPE = 'R' 
	AND	RCVRY.AGENCY.AGAGENCY = COLLID.CLAGENCY 
	AND	RCVRY.COLLID.CLCOLLID = ACTFIL.ACCIDNAM 
	AND	RCVRY.ACTFIL.ACRCCODE = RCVRY.ACTVERTB.AVCODE 
	AND RCVRY.ACTFIL.ACACCTG = RCVRY.ACTVERTB.AVACCTG
GROUP BY RCVRY.AGENCY.AGCITY, RCVRY.COLLID.CLAGENCY) TEL1
    
FULL OUTER JOIN

(SELECT RCVRY.AGENCY.AGCITY CUIDAD2, RCVRY.COLLID.CLAGENCY AGENCIA2, COUNT(RCVRY.ACTVERTB.AVCODE)ESTATUS_PROMESA2
FROM RCVRY.ACTVERTB, RCVRY.ACTFIL, RCVRY.COLLID, RCVRY.AGENCY
WHERE (RCVRY.ACTFIL.ACACCTG IN ('5','6')
		 AND TRUNC(RCVRY.ACTFIL.ACACTDTE) BETWEEN TRUNC(TO_DATE('01/07/2025','dd/mm/yyyy')) AND  TRUNC(SYSDATE) 
		 AND RCVRY.ACTVERTB.AVACCTG IN ('5','6')
		 AND RCVRY.ACTVERTB.AVTYPE = 'R' 
		 AND RCVRY.ACTFIL.ACACCODE IN ('LC','LM','LO','LR','PS')) 
	AND	RCVRY.AGENCY.AGAGENCY = COLLID.CLAGENCY 
	AND	RCVRY.COLLID.CLCOLLID = ACTFIL.ACCIDNAM 
	AND	RCVRY.ACTFIL.ACRCCODE = RCVRY.ACTVERTB.AVCODE 
    AND RCVRY.ACTFIL.ACACCTG = RCVRY.ACTVERTB.AVACCTG
GROUP BY RCVRY.AGENCY.AGCITY, RCVRY.COLLID.CLAGENCY) TEL2
ON CIUDAD=CUIDAD2
AND AGENCIA=AGENCIA2

FULL OUTER JOIN

(SELECT RCVRY.AGENCY.AGCITY CIUDAD3, RCVRY.COLLID.CLAGENCY AGENCIA3, COUNT(RCVRY.ACTVERTB.AVCODE)ESTATUS_PROMESA3 
FROM RCVRY.ACTVERTB, RCVRY.ACTFIL, RCVRY.COLLID, RCVRY.AGENCY 
WHERE      (RCVRY.ACTFIL.ACACCTG IN ('5','6')
		 AND TRUNC(RCVRY.ACTFIL.ACACTDTE) BETWEEN TRUNC(TO_DATE('01/07/2025','dd/mm/yyyy')) AND  TRUNC(SYSDATE) 
		 AND RCVRY.ACTVERTB.AVACCTG IN ('5','6')
		 AND RCVRY.ACTVERTB.AVTYPE = 'R'
		 AND RCVRY.ACTFIL.ACACCODE IN ('LC','LM','LO','LR')
		 AND RCVRY.ACTVERTB.AVCNTFLG = 0) 
	AND	RCVRY.AGENCY.AGAGENCY = RCVRY.COLLID.CLAGENCY 
	AND	RCVRY.COLLID.CLCOLLID = RCVRY.ACTFIL.ACCIDNAM 
	AND	RCVRY.ACTFIL.ACRCCODE = RCVRY.ACTVERTB.AVCODE 
    AND RCVRY.ACTFIL.ACACCTG = RCVRY.ACTVERTB.AVACCTG
GROUP BY RCVRY.AGENCY.AGCITY, RCVRY.COLLID.CLAGENCY) TEL3
ON CIUDAD=CIUDAD3
AND AGENCIA=AGENCIA3

FULL OUTER JOIN

(SELECT RCVRY.AGENCY.AGCITY CUIDAD4, RCVRY.COLLID.CLAGENCY AGENCIA4, COUNT(RCVRY.ACTVERTB.AVCODE)ESTATUS_PROMESA4
FROM RCVRY.ACTVERTB, RCVRY.ACTFIL, RCVRY.COLLID,RCVRY.AGENCY 
WHERE (RCVRY.ACTFIL.ACACCTG IN ('5','6')
		AND TRUNC(RCVRY.ACTFIL.ACACTDTE) BETWEEN TRUNC(TO_DATE('01/07/2025','dd/mm/yyyy')) AND  TRUNC(SYSDATE) 
		AND RCVRY.ACTVERTB.AVACCTG IN ('5','6')
		AND RCVRY.ACTVERTB.AVTYPE = 'R'
		AND RCVRY.ACTFIL.ACACCODE IN('LC','LM','LO','LR')
		AND RCVRY.ACTVERTB.AVCNTFLG = 1) 
	AND	RCVRY.AGENCY.AGAGENCY = RCVRY.COLLID.CLAGENCY 
	AND	RCVRY.COLLID.CLCOLLID = RCVRY.ACTFIL.ACCIDNAM 
	AND	RCVRY.ACTFIL.ACRCCODE = RCVRY.ACTVERTB.AVCODE 
	AND RCVRY.ACTFIL.ACACCTG = RCVRY.ACTVERTB.AVACCTG
GROUP BY RCVRY.AGENCY.AGCITY, RCVRY.COLLID.CLAGENCY) TEL4
ON CIUDAD=CUIDAD4
AND AGENCIA=AGENCIA4

FULL OUTER JOIN

(SELECT RCVRY.AGENCY.AGCITY CUIDAD5, RCVRY.COLLID.CLAGENCY AGENCIA5, COUNT(RCVRY.ACTVERTB.AVCODE)ESTATUS_PROMESA5
FROM RCVRY.ACTVERTB, RCVRY.ACTFIL, RCVRY.COLLID,RCVRY.AGENCY 
WHERE (RCVRY.ACTFIL.ACACCTG IN ('5','6')
		AND TRUNC(RCVRY.ACTFIL.ACACTDTE) BETWEEN TRUNC(TO_DATE('01/07/2025','dd/mm/yyyy')) AND  TRUNC(SYSDATE) 
		AND RCVRY.ACTVERTB.AVACCTG IN ('5','6')
		AND RCVRY.ACTVERTB.AVTYPE = 'R'
		AND RCVRY.ACTFIL.ACACCODE IN ('LC','LM','LO','LR')
		AND RCVRY.ACTVERTB.AVCNTFLG = 1
		AND RCVRY.ACTVERTB.AVCODE IN ('RF','RG','RO','RR','RT'))
	AND	RCVRY.AGENCY.AGAGENCY = RCVRY.COLLID.CLAGENCY 
	AND	RCVRY.COLLID.CLCOLLID = RCVRY.ACTFIL.ACCIDNAM 
	AND	RCVRY.ACTFIL.ACRCCODE = RCVRY.ACTVERTB.AVCODE
	AND RCVRY.ACTFIL.ACACCTG = RCVRY.ACTVERTB.AVACCTG
GROUP BY RCVRY.AGENCY.AGCITY, RCVRY.COLLID.CLAGENCY) TEL5
ON CIUDAD=CUIDAD5
AND AGENCIA=AGENCIA5

FULL OUTER JOIN

(SELECT RCVRY.AGENCY.AGCITY CUIDAD6, RCVRY.COLLID.CLAGENCY AGENCIA6, COUNT(RCVRY.ACTVERTB.AVCODE)ESTATUS_PROMESA6
FROM RCVRY.ACTVERTB, RCVRY.ACTFIL, RCVRY.COLLID,RCVRY.AGENCY 
WHERE (RCVRY.ACTFIL.ACACCTG IN ('5','6')
		AND TRUNC(RCVRY.ACTFIL.ACACTDTE) BETWEEN TRUNC(TO_DATE('01/07/2025','dd/mm/yyyy')) AND  TRUNC(SYSDATE) 
		AND RCVRY.ACTVERTB.AVACCTG IN ('5','6')
		AND RCVRY.ACTVERTB.AVTYPE = 'R' 
		AND RCVRY.ACTFIL.ACACCODE IN ('LC','LM','LO','LR')
		AND RCVRY.ACTVERTB.AVCNTFLG = 1
		AND RCVRY.ACTVERTB.AVCODE = 'PP') 
	AND	RCVRY.AGENCY.AGAGENCY = RCVRY.COLLID.CLAGENCY 
	AND	RCVRY.COLLID.CLCOLLID = RCVRY.ACTFIL.ACCIDNAM 
	AND	ACTFIL.ACRCCODE = RCVRY.ACTVERTB.AVCODE 
	AND RCVRY.ACTFIL.ACACCTG = RCVRY.ACTVERTB.AVACCTG
GROUP BY RCVRY.AGENCY.AGCITY, RCVRY.COLLID.CLAGENCY) TEL6
ON CIUDAD=CUIDAD6
AND AGENCIA=AGENCIA6

FULL OUTER JOIN

(SELECT RCVRY.AGENCY.AGCITY CUIDADC, RCVRY.COLLID.CLAGENCY AGENCIAC, COUNT(RCVRY.PTPSCHED.PPFLAG)ESTATUS_PROMESAC 
FROM RCVRY.PTPSCHED, RCVRY.ACTFIL, RCVRY.COLLID, RCVRY.AGENCY 
WHERE (RCVRY.ACTFIL.ACACCTG IN ('5','6')
		AND TRUNC(RCVRY.ACTFIL.ACACTDTE) BETWEEN TRUNC(TO_DATE('01/07/2025','dd/mm/yyyy')) AND  TRUNC(SYSDATE) 
		AND RCVRY.ACTFIL.ACACCODE IN ('LC','LM','LR','LO')
		AND RCVRY.PTPSCHED.PPACCTG IN ('5','6')
		AND TRUNC(RCVRY.PTPSCHED.PPDUE) BETWEEN TRUNC(TO_DATE('01/07/2025','dd/mm/yyyy')) AND  TRUNC(SYSDATE) 
		AND RCVRY.PTPSCHED.PPFLAG = 'C'
		AND RCVRY.ACTFIL.ACRCCODE = 'PP') 
	AND	RCVRY.AGENCY.AGAGENCY = RCVRY.COLLID.CLAGENCY 
	AND	RCVRY.COLLID.CLCOLLID = RCVRY.ACTFIL.ACCIDNAM 
	AND	RCVRY.ACTFIL.ACACCTG = RCVRY.PTPSCHED.PPACCTG 
	AND	RCVRY.ACTFIL.ACACCT = RCVRY.PTPSCHED.PPACCT 
	AND	RCVRY.ACTFIL.ACCIDNAM = RCVRY.PTPSCHED.PPCOLLID 
GROUP BY RCVRY.AGENCY.AGCITY, RCVRY.COLLID.CLAGENCY) TELC
ON CIUDAD=CUIDADC
AND AGENCIA=AGENCIAC

FULL OUTER JOIN

(SELECT	RCVRY.AGENCY.AGCITY CUIDADR, RCVRY.COLLID.CLAGENCY AGENCIAR, COUNT(RCVRY.PTPSCHED.PPFLAG)ESTATUS_PROMESAR
FROM RCVRY.PTPSCHED, RCVRY.ACTFIL, RCVRY.COLLID, RCVRY.AGENCY 
WHERE(RCVRY.ACTFIL.ACACCTG IN ('5','6')
		AND TRUNC(RCVRY.ACTFIL.ACACTDTE) BETWEEN TRUNC(TO_DATE('01/07/2025','dd/mm/yyyy')) AND  TRUNC(SYSDATE)
		AND RCVRY.ACTFIL.ACACCODE IN('LC','LM','LR','LO')
		AND RCVRY.PTPSCHED.PPACCTG IN ('5','6')
		AND TRUNC(RCVRY.PTPSCHED.PPDUE) BETWEEN TRUNC(TO_DATE('01/07/2025','dd/mm/yyyy')) AND  TRUNC(SYSDATE) 
		AND RCVRY.PTPSCHED.PPFLAG = 'R' 
		AND RCVRY.ACTFIL.ACRCCODE = 'PP')
	AND	RCVRY.AGENCY.AGAGENCY = RCVRY.COLLID.CLAGENCY 
	AND	RCVRY.COLLID.CLCOLLID = RCVRY.ACTFIL.ACCIDNAM 
	AND	RCVRY.ACTFIL.ACACCTG = RCVRY.PTPSCHED.PPACCTG 
	AND	RCVRY.ACTFIL.ACACCT = RCVRY.PTPSCHED.PPACCT 
	AND	RCVRY.ACTFIL.ACCIDNAM = RCVRY.PTPSCHED.PPCOLLID 
GROUP BY RCVRY.AGENCY.AGCITY, RCVRY.COLLID.CLAGENCY) TELR
ON CIUDAD=CUIDADR
AND AGENCIA=AGENCIAR

FULL OUTER JOIN

(SELECT RCVRY.AGENCY.AGCITY CIUDAD_VIS2, RCVRY.COLLID.CLAGENCY AGENCIA_VIS2, COUNT(RCVRY.ACTVERTB.AVCODE) ESTATUS_PROMESA_VIS2
FROM RCVRY.ACTVERTB, RCVRY.ACTFIL, RCVRY.COLLID,RCVRY.AGENCY 
WHERE (RCVRY.ACTFIL.ACACCTG IN ('5','6')
        AND TRUNC(RCVRY.ACTFIL.ACACTDTE) BETWEEN TRUNC(TO_DATE('01/07/2025','dd/mm/yyyy')) AND  TRUNC(SYSDATE) 
        AND RCVRY.ACTVERTB.AVACCTG IN ('5','6')
        AND RCVRY.ACTVERTB.AVTYPE = 'R' 
        AND RCVRY.ACTFIL.ACACCODE IN('VD','VO','VT')) 
	    AND RCVRY.AGENCY.AGAGENCY = RCVRY.COLLID.CLAGENCY 
	    AND RCVRY.COLLID.CLCOLLID = RCVRY.ACTFIL.ACCIDNAM 
	    AND RCVRY.ACTFIL.ACRCCODE = RCVRY.ACTVERTB.AVCODE 
	    AND RCVRY.ACTFIL.ACACCTG = RCVRY.ACTVERTB.AVACCTG
GROUP BY RCVRY.AGENCY.AGCITY, RCVRY.COLLID.CLAGENCY) VIS2
ON CIUDAD=CIUDAD_VIS2
AND AGENCIA=AGENCIA_VIS2

FULL OUTER JOIN

(SELECT RCVRY.AGENCY.AGCITY CIUDAD_VIS3, RCVRY.COLLID.CLAGENCY AGENCIA_VIS3, COUNT(RCVRY.ACTVERTB.AVCODE) ESTATUS_PROMESA_VIS3
FROM RCVRY.ACTVERTB, RCVRY.ACTFIL, RCVRY.COLLID,RCVRY.AGENCY 
WHERE (ACTFIL.ACACCTG IN ('5','6')
            AND TRUNC(RCVRY.ACTFIL.ACACTDTE) BETWEEN TRUNC(TO_DATE('01/07/2025','dd/mm/yyyy')) AND  TRUNC(SYSDATE) 
			AND	RCVRY.ACTVERTB.AVACCTG IN ('5','6')
			AND RCVRY.ACTVERTB.AVTYPE = 'R' 
			AND RCVRY.ACTFIL.ACACCODE IN ('VD','VO','VT') 
			AND	RCVRY.ACTVERTB.AVCNTFLG = 0) 
	AND RCVRY.AGENCY.AGAGENCY = RCVRY.COLLID.CLAGENCY 
	AND RCVRY.COLLID.CLCOLLID = RCVRY.ACTFIL.ACCIDNAM 
	AND ACTFIL.ACRCCODE = RCVRY.ACTVERTB.AVCODE 
    AND RCVRY.ACTFIL.ACACCTG = RCVRY.ACTVERTB.AVACCTG
GROUP BY RCVRY.AGENCY.AGCITY, RCVRY.COLLID.CLAGENCY) VIS3
ON CIUDAD=CIUDAD_VIS3
AND AGENCIA=AGENCIA_VIS3

FULL OUTER JOIN

(SELECT	RCVRY.AGENCY.AGCITY CIUDAD_VIS4, RCVRY.COLLID.CLAGENCY AGENCIA_VIS4, COUNT(RCVRY.ACTVERTB.AVCODE) ESTATUS_PROMESA_VIS4
FROM RCVRY.ACTVERTB, RCVRY.ACTFIL, RCVRY.COLLID,RCVRY.AGENCY 
WHERE (RCVRY.ACTFIL.ACACCTG IN ('5','6')
            AND	TRUNC(RCVRY.ACTFIL.ACACTDTE) BETWEEN TRUNC(TO_DATE('01/07/2025','dd/mm/yyyy')) AND  TRUNC(SYSDATE) 
			AND	RCVRY.ACTVERTB.AVACCTG IN ('5','6')
			AND	RCVRY.ACTVERTB.AVTYPE = 'R' 
			AND	RCVRY.ACTFIL.ACACCODE IN ('VD','VO','VT') 
			AND RCVRY.ACTVERTB.AVCNTFLG = 1) 
	AND RCVRY.AGENCY.AGAGENCY = RCVRY.COLLID.CLAGENCY 
	AND RCVRY.COLLID.CLCOLLID = RCVRY.ACTFIL.ACCIDNAM 
	AND RCVRY.ACTFIL.ACRCCODE = RCVRY.ACTVERTB.AVCODE 
	AND RCVRY.ACTFIL.ACACCTG = RCVRY.ACTVERTB.AVACCTG
GROUP BY RCVRY.AGENCY.AGCITY, RCVRY.COLLID.CLAGENCY) VIS4
ON CIUDAD=CIUDAD_VIS4
AND AGENCIA=AGENCIA_VIS4

FULL OUTER JOIN

(SELECT RCVRY.AGENCY.AGCITY CIUDAD_VIS5, RCVRY.COLLID.CLAGENCY AGENCIA_VIS5, COUNT(RCVRY.ACTVERTB.AVCODE) ESTATUS_PROMESA_VIS5
FROM RCVRY.ACTVERTB, RCVRY.ACTFIL, RCVRY.COLLID,RCVRY.AGENCY 
WHERE (RCVRY.ACTFIL.ACACCTG IN ('5','6') 
            AND	TRUNC(RCVRY.ACTFIL.ACACTDTE) BETWEEN TRUNC(TO_DATE('01/07/2025','dd/mm/yyyy')) AND  TRUNC(SYSDATE) 
			AND	RCVRY.ACTVERTB.AVACCTG IN ('5','6') 
			AND	RCVRY.ACTVERTB.AVTYPE = 'R' 
			AND	RCVRY.ACTFIL.ACACCODE IN('VD','VO','VT') 
			AND	RCVRY.ACTVERTB.AVCNTFLG = 1 
			AND RCVRY.ACTVERTB.AVCODE IN ('AF','AO','AP','AT','AV')) 
	AND RCVRY.AGENCY.AGAGENCY = RCVRY.COLLID.CLAGENCY 
	AND RCVRY.COLLID.CLCOLLID = RCVRY.ACTFIL.ACCIDNAM 
	AND RCVRY.ACTFIL.ACRCCODE = RCVRY.ACTVERTB.AVCODE 
	AND RCVRY.ACTFIL.ACACCTG = RCVRY.ACTVERTB.AVACCTG
GROUP BY RCVRY.AGENCY.AGCITY, RCVRY.COLLID.CLAGENCY) VIS5
ON CIUDAD=CIUDAD_VIS5
AND AGENCIA=AGENCIA_VIS5

FULL OUTER JOIN

(SELECT RCVRY.AGENCY.AGCITY CIUDAD_VIS6, RCVRY.COLLID.CLAGENCY AGENCIA_VIS6, COUNT(RCVRY.ACTVERTB.AVCODE) ESTATUS_PROMESA_VIS6
FROM RCVRY.ACTVERTB, RCVRY.ACTFIL, RCVRY.COLLID,RCVRY.AGENCY 
WHERE (RCVRY.ACTFIL.ACACCTG IN ('5','6') 
            AND	TRUNC(RCVRY.ACTFIL.ACACTDTE) BETWEEN TRUNC(TO_DATE('01/07/2025','dd/mm/yyyy')) AND  TRUNC(SYSDATE) 
			AND	RCVRY.ACTVERTB.AVACCTG IN ('5','6') 
			AND	RCVRY.ACTVERTB.AVTYPE = 'R' 
			AND	RCVRY.ACTFIL.ACACCODE IN('VD','VO','VT') 
			AND	RCVRY.ACTVERTB.AVCNTFLG = 1 
			AND	RCVRY.ACTVERTB.AVCODE IN('PP')) 
	AND RCVRY.AGENCY.AGAGENCY = RCVRY.COLLID.CLAGENCY 
	AND RCVRY.COLLID.CLCOLLID = RCVRY.ACTFIL.ACCIDNAM 
	AND RCVRY.ACTFIL.ACRCCODE = RCVRY.ACTVERTB.AVCODE
	AND RCVRY.ACTFIL.ACACCTG = RCVRY.ACTVERTB.AVACCTG
GROUP BY RCVRY.AGENCY.AGCITY, RCVRY.COLLID.CLAGENCY) VIS6
ON CIUDAD=CIUDAD_VIS6
AND AGENCIA=AGENCIA_VIS6

FULL OUTER JOIN

(SELECT RCVRY.AGENCY.AGCITY CIUDAD_VISC, RCVRY.COLLID.CLAGENCY AGENCIA_VISC, COUNT(RCVRY.PTPSCHED.PPFLAG) ESTATUS_PROMESA_VISC
FROM RCVRY.PTPSCHED, RCVRY.ACTFIL, RCVRY.COLLID,RCVRY.AGENCY 
WHERE (RCVRY.ACTFIL.ACACCTG IN ('5','6') 
            AND	TRUNC(RCVRY.ACTFIL.ACACTDTE) BETWEEN TRUNC(TO_DATE('01/07/2025','dd/mm/yyyy')) AND  TRUNC(SYSDATE) 
			AND	RCVRY.ACTFIL.ACACCODE IN('VD','VO','VT') 
			AND	RCVRY.PTPSCHED.PPACCTG IN ('5','6')  
			AND	TRUNC(RCVRY.PTPSCHED.PPDUE) BETWEEN TRUNC(TO_DATE('01/07/2025','dd/mm/yyyy')) AND  TRUNC(SYSDATE) 
			AND	RCVRY.PTPSCHED.PPFLAG = 'C' 
			AND	RCVRY.ACTFIL.ACRCCODE = 'PP')
	AND	RCVRY.AGENCY.AGAGENCY = COLLID.CLAGENCY 
	AND	RCVRY.COLLID.CLCOLLID = ACTFIL.ACCIDNAM 
	AND	RCVRY.ACTFIL.ACACCTG = PTPSCHED.PPACCTG 
	AND	RCVRY.ACTFIL.ACACCT = PTPSCHED.PPACCT 
	AND	RCVRY.ACTFIL.ACCIDNAM = PTPSCHED.PPCOLLID 
GROUP BY RCVRY.AGENCY.AGCITY, RCVRY.COLLID.CLAGENCY) VISC
ON CIUDAD=CIUDAD_VISC
AND AGENCIA=AGENCIA_VISC

FULL OUTER JOIN

(SELECT RCVRY.AGENCY.AGCITY CIUDAD_VISR, RCVRY.COLLID.CLAGENCY AGENCIA_VISR, COUNT(RCVRY.PTPSCHED.PPFLAG) ESTATUS_PROMESA_VISR
FROM RCVRY.PTPSCHED, RCVRY.ACTFIL, RCVRY.COLLID,RCVRY.AGENCY 
WHERE (RCVRY.ACTFIL.ACACCTG IN ('5','6')  
            AND	TRUNC(RCVRY.ACTFIL.ACACTDTE) BETWEEN TRUNC(TO_DATE('01/07/2025','dd/mm/yyyy')) AND  TRUNC(SYSDATE) 
			AND	RCVRY.ACTFIL.ACACCODE IN('VD','VO','VT') 
			AND	RCVRY.PTPSCHED.PPACCTG IN ('5','6')  
			AND	TRUNC(RCVRY.PTPSCHED.PPDUE) BETWEEN TRUNC(TO_DATE('01/07/2025','dd/mm/yyyy')) AND  TRUNC(SYSDATE) 
			AND RCVRY.PTPSCHED.PPFLAG = 'R' 
			AND RCVRY.ACTFIL.ACRCCODE = 'PP') 
	AND RCVRY.AGENCY.AGAGENCY = RCVRY.COLLID.CLAGENCY 
	AND RCVRY.COLLID.CLCOLLID = RCVRY.ACTFIL.ACCIDNAM 
	AND RCVRY.ACTFIL.ACACCTG = RCVRY.PTPSCHED.PPACCTG 
	AND RCVRY.ACTFIL.ACACCT = RCVRY.PTPSCHED.PPACCT 
	AND RCVRY.ACTFIL.ACCIDNAM = RCVRY.PTPSCHED.PPCOLLID 
GROUP BY RCVRY.AGENCY.AGCITY, RCVRY.COLLID.CLAGENCY) VISR
ON CIUDAD=CIUDAD_VISR
AND AGENCIA=AGENCIA_VISR

FULL OUTER JOIN

(SELECT RCVRY.AGENCY.AGCITY CIUDAD_INB2, RCVRY.COLLID.CLAGENCY AGENCIA_INB2, COUNT(RCVRY.ACTVERTB.AVCODE) ESTATUS_PROMESA_INB2
FROM RCVRY.ACTVERTB, RCVRY.ACTFIL, RCVRY.COLLID,RCVRY.AGENCY 
WHERE (RCVRY.ACTFIL.ACACCTG IN ('5','6')
            AND	TRUNC(RCVRY.ACTFIL.ACACTDTE) BETWEEN TRUNC(TO_DATE('01/07/2025','dd/mm/yyyy')) AND  TRUNC(SYSDATE) 
			AND	RCVRY.ACTVERTB.AVACCTG IN ('5','6')
			AND	RCVRY.ACTVERTB.AVTYPE = 'R' 
			AND	RCVRY.ACTFIL.ACACCODE IN('VI','LI'))
	AND	RCVRY.AGENCY.AGAGENCY = RCVRY.COLLID.CLAGENCY 
	AND	RCVRY.COLLID.CLCOLLID = RCVRY.ACTFIL.ACCIDNAM 
	AND	RCVRY.ACTFIL.ACRCCODE = RCVRY.ACTVERTB.AVCODE
	AND RCVRY.ACTFIL.ACACCTG = RCVRY.ACTVERTB.AVACCTG
GROUP BY RCVRY.AGENCY.AGCITY, RCVRY.COLLID.CLAGENCY) INB2
ON CIUDAD=CIUDAD_INB2
AND AGENCIA=AGENCIA_INB2

FULL OUTER JOIN

(SELECT RCVRY.AGENCY.AGCITY CIUDAD_INB3, RCVRY.COLLID.CLAGENCY AGENCIA_INB3, COUNT(RCVRY.ACTVERTB.AVCODE) ESTATUS_PROMESA_INB3
FROM RCVRY.ACTVERTB, RCVRY.ACTFIL, RCVRY.COLLID, RCVRY.AGENCY 
WHERE (ACTFIL.ACACCTG IN ('5','6') 
             AND TRUNC(RCVRY.ACTFIL.ACACTDTE) BETWEEN TRUNC(TO_DATE('01/07/2025','dd/mm/yyyy')) AND  TRUNC(SYSDATE) 
			 AND RCVRY.ACTVERTB.AVACCTG IN ('5','6') 
			 AND RCVRY.ACTVERTB.AVTYPE = 'R' 
			 AND RCVRY.ACTFIL.ACACCODE IN('VI','LI') 
			 AND RCVRY.ACTVERTB.AVCNTFLG = 0) 
	AND	RCVRY.AGENCY.AGAGENCY =  RCVRY.COLLID.CLAGENCY 
	AND	RCVRY.COLLID.CLCOLLID =  RCVRY.ACTFIL.ACCIDNAM 
	AND	RCVRY.ACTFIL.ACRCCODE =  RCVRY.ACTVERTB.AVCODE
	AND RCVRY.ACTFIL.ACACCTG = RCVRY.ACTVERTB.AVACCTG
GROUP BY RCVRY.AGENCY.AGCITY, RCVRY.COLLID.CLAGENCY) INB3
ON CIUDAD=CIUDAD_INB3
AND AGENCIA=AGENCIA_INB3

FULL OUTER JOIN

(SELECT	RCVRY.AGENCY.AGCITY CIUDAD_INB4,  RCVRY.COLLID.CLAGENCY AGENCIA_INB4, COUNT(RCVRY.ACTVERTB.AVCODE) ESTATUS_PROMESA_INB4
FROM RCVRY.ACTVERTB, RCVRY.ACTFIL, RCVRY.COLLID,RCVRY.AGENCY 
WHERE ( RCVRY.ACTFIL.ACACCTG IN ('5','6') 
            AND	TRUNC(RCVRY.ACTFIL.ACACTDTE) BETWEEN TRUNC(TO_DATE('01/07/2025','dd/mm/yyyy')) AND  TRUNC(SYSDATE) 
			AND	RCVRY.ACTVERTB.AVACCTG IN ('5','6') 
			AND	RCVRY.ACTVERTB.AVTYPE = 'R' 
			AND RCVRY.ACTFIL.ACACCODE IN('VI','LI') 
		    AND RCVRY.ACTVERTB.AVCNTFLG = 1) 
	AND	RCVRY.AGENCY.AGAGENCY =  RCVRY.COLLID.CLAGENCY 
	AND	RCVRY.COLLID.CLCOLLID =  RCVRY.ACTFIL.ACCIDNAM 
	AND	RCVRY.ACTFIL.ACRCCODE = RCVRY.ACTVERTB.AVCODE
	AND RCVRY.ACTFIL.ACACCTG = RCVRY.ACTVERTB.AVACCTG
GROUP BY RCVRY.AGENCY.AGCITY, RCVRY.COLLID.CLAGENCY) INB4
ON CIUDAD=CIUDAD_INB4
AND AGENCIA=AGENCIA_INB4

FULL OUTER JOIN

(SELECT RCVRY.AGENCY.AGCITY CIUDAD_INB5,  RCVRY.COLLID.CLAGENCY AGENCIA_INB5, COUNT(RCVRY.ACTVERTB.AVCODE) ESTATUS_PROMESA_INB5
FROM RCVRY.ACTVERTB, RCVRY.ACTFIL, RCVRY.COLLID,RCVRY.AGENCY 
WHERE ( RCVRY.ACTFIL.ACACCTG IN ('5','6') 
             AND TRUNC(RCVRY.ACTFIL.ACACTDTE) BETWEEN TRUNC(TO_DATE('01/07/2025','dd/mm/yyyy')) AND  TRUNC(SYSDATE) 
			 AND RCVRY.ACTVERTB.AVACCTG IN ('5','6') 
			 AND RCVRY.ACTVERTB.AVTYPE = 'R' 
			 AND RCVRY.ACTFIL.ACACCODE IN('VI','LI') 
			 AND RCVRY.ACTVERTB.AVCNTFLG = 1 
			 AND RCVRY.ACTVERTB.AVCODE <> 'PP') 
	AND	RCVRY.AGENCY.AGAGENCY = RCVRY.COLLID.CLAGENCY 
	AND RCVRY.COLLID.CLCOLLID = RCVRY.ACTFIL.ACCIDNAM 
	AND RCVRY.ACTFIL.ACRCCODE = RCVRY.ACTVERTB.AVCODE 
	AND RCVRY.ACTFIL.ACACCTG = RCVRY.ACTVERTB.AVACCTG
GROUP BY RCVRY.AGENCY.AGCITY, RCVRY.COLLID.CLAGENCY) INB5
ON CIUDAD=CIUDAD_INB5
AND AGENCIA=AGENCIA_INB5

FULL OUTER JOIN

(SELECT RCVRY.AGENCY.AGCITY CIUDAD_INB6,  RCVRY.COLLID.CLAGENCY AGENCIA_INB6, COUNT(RCVRY.ACTVERTB.AVCODE) ESTATUS_PROMESA_INB6
FROM RCVRY.ACTVERTB, RCVRY.ACTFIL, RCVRY.COLLID,RCVRY.AGENCY 
WHERE ( RCVRY.ACTFIL.ACACCTG IN ('5','6') 
            AND	TRUNC(RCVRY.ACTFIL.ACACTDTE) BETWEEN TRUNC(TO_DATE('01/07/2025','dd/mm/yyyy')) AND  TRUNC(SYSDATE) 
			AND	RCVRY.ACTVERTB.AVACCTG IN ('5','6') 
			AND	RCVRY.ACTVERTB.AVTYPE = 'R' 
			AND	RCVRY.ACTFIL.ACACCODE IN('VI','LI') 
			AND	RCVRY.ACTVERTB.AVCNTFLG = 1 
			AND	RCVRY.ACTVERTB.AVCODE = 'PP') 
	AND	 RCVRY.AGENCY.AGAGENCY =  RCVRY.COLLID.CLAGENCY 
	AND	 RCVRY.COLLID.CLCOLLID =  RCVRY.ACTFIL.ACCIDNAM 
	AND	 RCVRY.ACTFIL.ACRCCODE =  RCVRY.ACTVERTB.AVCODE 
	AND RCVRY.ACTFIL.ACACCTG = RCVRY.ACTVERTB.AVACCTG
GROUP BY RCVRY.AGENCY.AGCITY, RCVRY.COLLID.CLAGENCY) INB6
ON CIUDAD=CIUDAD_INB6
AND AGENCIA=AGENCIA_INB6

FULL OUTER JOIN

(SELECT RCVRY.AGENCY.AGCITY CIUDAD_INBC,  RCVRY.COLLID.CLAGENCY AGENCIA_INBC, COUNT( RCVRY.PTPSCHED.PPFLAG) ESTATUS_PROMESA_INBC
FROM  RCVRY.PTPSCHED, RCVRY.ACTFIL, RCVRY.COLLID,RCVRY.AGENCY
WHERE ( RCVRY.ACTFIL.ACACCTG IN ('5','6') 
             AND TRUNC(RCVRY.ACTFIL.ACACTDTE) BETWEEN TRUNC(TO_DATE('01/07/2025','dd/mm/yyyy')) AND  TRUNC(SYSDATE) 
			 AND RCVRY.ACTFIL.ACACCODE IN('VI','LI') 
			 AND RCVRY.PTPSCHED.PPACCTG IN ('5','6') 
			 AND TRUNC(RCVRY.PTPSCHED.PPDUE) BETWEEN TRUNC(TO_DATE('01/07/2025','dd/mm/yyyy')) AND  TRUNC(SYSDATE) 
			 AND RCVRY.PTPSCHED.PPFLAG = 'C' 
			 AND RCVRY.ACTFIL.ACRCCODE = 'PP')
	AND	 RCVRY.AGENCY.AGAGENCY =  RCVRY.COLLID.CLAGENCY 
	AND	 RCVRY.COLLID.CLCOLLID =  RCVRY.ACTFIL.ACCIDNAM 
	AND	 RCVRY.ACTFIL.ACACCTG =  RCVRY.PTPSCHED.PPACCTG 
	AND	 RCVRY.ACTFIL.ACACCT  =  RCVRY.PTPSCHED.PPACCT 
	AND	 RCVRY.ACTFIL.ACCIDNAM =  RCVRY.PTPSCHED.PPCOLLID 
GROUP BY RCVRY.AGENCY.AGCITY, RCVRY.COLLID.CLAGENCY) INBC
ON CIUDAD=CIUDAD_INBC
AND AGENCIA=AGENCIA_INBC

FULL OUTER JOIN

(SELECT RCVRY.AGENCY.AGCITY CIUDAD_INBR,  RCVRY.COLLID.CLAGENCY AGENCIA_INBR, COUNT( RCVRY.PTPSCHED.PPFLAG) ESTATUS_PROMESA_INBR 
FROM  RCVRY.PTPSCHED, RCVRY.ACTFIL, RCVRY.COLLID,	RCVRY.AGENCY 
WHERE ( RCVRY.ACTFIL.ACACCTG IN ('5','6') 
             AND TRUNC(RCVRY.ACTFIL.ACACTDTE) BETWEEN TRUNC(TO_DATE('01/07/2025','dd/mm/yyyy')) AND  TRUNC(SYSDATE) 
			 AND RCVRY.ACTFIL.ACACCODE IN ('VI','LI') 
			 AND RCVRY.PTPSCHED.PPACCTG IN ('5','6') 
			 AND TRUNC(RCVRY.PTPSCHED.PPDUE) BETWEEN TRUNC(TO_DATE('01/07/2025','dd/mm/yyyy')) AND  TRUNC(SYSDATE) 
			 AND RCVRY.PTPSCHED.PPFLAG = 'R' 
			 AND RCVRY.ACTFIL.ACRCCODE = 'PP')
	AND	RCVRY.AGENCY.AGAGENCY = RCVRY.COLLID.CLAGENCY 
	AND	RCVRY.COLLID.CLCOLLID = RCVRY.ACTFIL.ACCIDNAM 
	AND	RCVRY.ACTFIL.ACACCTG =  RCVRY.PTPSCHED.PPACCTG 
	AND	RCVRY.ACTFIL.ACACCT =   RCVRY.PTPSCHED.PPACCT 
	AND	RCVRY.ACTFIL.ACCIDNAM = RCVRY.PTPSCHED.PPCOLLID 
GROUP BY RCVRY.AGENCY.AGCITY, RCVRY.COLLID.CLAGENCY) INBR
ON CIUDAD=CIUDAD_INBR
AND AGENCIA=AGENCIA_INBR

FULL OUTER JOIN

(SELECT RCVRY.AGENCY.AGCITY CIUDAD_MEN2,  RCVRY.COLLID.CLAGENCY AGENCIA_MEN2, COUNT(RCVRY.ACTVERTB.AVCODE) ESTATUS_PROMESA_MEN2
FROM RCVRY.ACTVERTB, RCVRY.ACTFIL, RCVRY.COLLID,RCVRY.AGENCY 
WHERE ( RCVRY.ACTFIL.ACACCTG IN ('5','6')   
            AND	TRUNC(RCVRY.ACTFIL.ACACTDTE) BETWEEN TRUNC(TO_DATE('01/07/2025','dd/mm/yyyy')) AND  TRUNC(SYSDATE) 
			AND	RCVRY.ACTVERTB.AVACCTG IN ('5','6')   
			AND	RCVRY.ACTVERTB.AVTYPE = 'R' 
			AND	RCVRY.ACTFIL.ACACCODE IN('MD','MS')) 
	AND	RCVRY.AGENCY.AGAGENCY =  RCVRY.COLLID.CLAGENCY 
	AND	RCVRY.COLLID.CLCOLLID =  RCVRY.ACTFIL.ACCIDNAM 
	AND	RCVRY.ACTFIL.ACRCCODE =  RCVRY.ACTVERTB.AVCODE 
	AND RCVRY.ACTFIL.ACACCTG = RCVRY.ACTVERTB.AVACCTG
GROUP BY RCVRY.AGENCY.AGCITY,COLLID.CLAGENCY) MEN2
ON CIUDAD=CIUDAD_MEN2
AND AGENCIA=AGENCIA_MEN2

FULL OUTER JOIN

(SELECT RCVRY.AGENCY.AGCITY CIUDAD_MEN3,  RCVRY.COLLID.CLAGENCY AGENCIA_MEN3, COUNT(RCVRY.ACTVERTB.AVCODE) ESTATUS_PROMESA_MEN3
FROM RCVRY.ACTVERTB, RCVRY.ACTFIL, RCVRY.COLLID,RCVRY.AGENCY 
WHERE ( RCVRY.ACTFIL.ACACCTG IN ('5','6')  
            AND	TRUNC(RCVRY.ACTFIL.ACACTDTE) BETWEEN TRUNC(TO_DATE('01/07/2025','dd/mm/yyyy')) AND  TRUNC(SYSDATE) 
			AND	RCVRY.ACTVERTB.AVACCTG IN ('5','6')  
			AND	RCVRY.ACTVERTB.AVTYPE = 'R' 
			AND	RCVRY.ACTFIL.ACACCODE IN ('MD','MS') 
			AND	RCVRY.ACTVERTB.AVCODE = 'MR') 
	AND	RCVRY.AGENCY.AGAGENCY =  RCVRY.COLLID.CLAGENCY 
	AND	RCVRY.COLLID.CLCOLLID =  RCVRY.ACTFIL.ACCIDNAM 
	AND	RCVRY.ACTFIL.ACRCCODE =  RCVRY.ACTVERTB.AVCODE
	AND RCVRY.ACTFIL.ACACCTG = RCVRY.ACTVERTB.AVACCTG 
GROUP BY RCVRY.AGENCY.AGCITY,  RCVRY.COLLID.CLAGENCY) MEN3
ON CIUDAD=CIUDAD_MEN3
AND AGENCIA=AGENCIA_MEN3

FULL OUTER JOIN

(SELECT	RCVRY.AGENCY.AGCITY CIUDAD_MEN4,  RCVRY.COLLID.CLAGENCY AGENCIA_MEN4, COUNT(RCVRY.ACTVERTB.AVCODE) ESTATUS_PROMESA_MEN4
FROM RCVRY.ACTVERTB, RCVRY.ACTFIL, RCVRY.COLLID,RCVRY.AGENCY 
WHERE ( RCVRY.ACTFIL.ACACCTG IN ('5','6') 
            AND	TRUNC(RCVRY.ACTFIL.ACACTDTE) BETWEEN TRUNC(TO_DATE('01/07/2025','dd/mm/yyyy')) AND  TRUNC(SYSDATE) 
			AND	RCVRY.ACTVERTB.AVACCTG IN ('5','6') 
			AND	RCVRY.ACTVERTB.AVTYPE = 'R' 
			AND	RCVRY.ACTFIL.ACACCODE IN('MD','MS') 
			AND	RCVRY.ACTVERTB.AVCODE = 'CE')
	AND	RCVRY.AGENCY.AGAGENCY =  RCVRY.COLLID.CLAGENCY 
	AND	RCVRY.COLLID.CLCOLLID =  RCVRY.ACTFIL.ACCIDNAM 
	AND	RCVRY.ACTFIL.ACRCCODE =  RCVRY.ACTVERTB.AVCODE 
	AND RCVRY.ACTFIL.ACACCTG = RCVRY.ACTVERTB.AVACCTG
GROUP BY RCVRY.AGENCY.AGCITY, RCVRY.COLLID.CLAGENCY) MEN4
ON CIUDAD=CIUDAD_MEN4
AND AGENCIA=AGENCIA_MEN4

FULL OUTER JOIN

(SELECT RCVRY.AGENCY.AGCITY CIUDAD_MEN5,  RCVRY.COLLID.CLAGENCY AGENCIA_MEN5, COUNT(RCVRY.ACTVERTB.AVCODE) ESTATUS_PROMESA_MEN5
FROM RCVRY.ACTVERTB, RCVRY.ACTFIL, RCVRY.COLLID,RCVRY.AGENCY 
WHERE( RCVRY.ACTFIL.ACACCTG IN ('5','6')  
            AND	TRUNC(RCVRY.ACTFIL.ACACTDTE)  BETWEEN TRUNC(TO_DATE('01/07/2025','dd/mm/yyyy')) and  TRUNC(SYSDATE) 
			AND	RCVRY.ACTVERTB.AVACCTG IN ('5','6')  
			AND	RCVRY.ACTVERTB.AVTYPE = 'R' 
			AND	RCVRY.ACTFIL.ACACCODE IN('MD','MS')
			AND RCVRY.ACTVERTB.AVCODE = 'SM')
	AND	RCVRY.AGENCY.AGAGENCY =   RCVRY.COLLID.CLAGENCY 
	AND	 RCVRY.COLLID.CLCOLLID =  RCVRY.ACTFIL.ACCIDNAM 
	AND	 RCVRY.ACTFIL.ACRCCODE =  RCVRY.ACTVERTB.AVCODE
	AND RCVRY.ACTFIL.ACACCTG = RCVRY.ACTVERTB.AVACCTG
GROUP BY RCVRY.AGENCY.AGCITY, RCVRY.COLLID.CLAGENCY) MEN5
ON CIUDAD=CIUDAD_MEN5
AND AGENCIA=AGENCIA_MEN5

ORDER BY CIUDAD ASC, AGENCIA ASC
